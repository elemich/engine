SDKDIR=c:\sdk

MINGWDIR=$(SDKDIR)\mingw32
MINGWINCLUDESDIR=$(MINGWDIR)\include
MINGWLIBSDIR=$(MINGWDIR)\lib
COMPILER=$(MINGWDIR)\bin\g++.exe

OPENGLSDK=$(SDKDIR)\OpenGL
FBXSDK="$(SDKDIR)\Autodesk\FBX\FBX SDK\2014.1\include"
CLANGDIR=$(SDKDIR)\LLVM
LLVMSRCDIR=$(SDKDIR)\llvm_src\llvm-8.0.0.src

INCPATH=-I$(MINGWINCLUDESDIR) -I$(OPENGLSDK) -I$(FBXSDK) -I$(CLANGDIR)\include -I$(LLVMSRCDIR)\include -I$(LLVMSRCDIR)\bin\include
LIBPATH=-L$(MINGWLIBSDIR) -L$(CLANGDIR)\lib -L$(CLANGDIR)\bin -L$(LLVMSRCDIR)\bin\lib -L"$(SDKDIR)\Autodesk\FBX\FBX SDK\2014.1\lib\vs2010\x64\release"

CLOPT=-fpermissive -w -O0 -g -DCREATEDLL -DEDITORBUILD $(INCPATH) -c

STATICCPPDRIVER= -static -lstdc++

WIN32LIBD= $(STATICCPPDRIVER) -luuid -lOle32 -luser32 -lopengl32 -lD3D11 -ld2d1 -lDwrite -lWindowscodecs -lComdlg32 -lGdi32 -lShlwapi -lWinmm -lComctl32 -lShell32 -lkernel32 
FBXLIB=-llibfbxsdk-md -ladvapi32
CLANGLIB=-l:libclang.lib
LLVMLIBS=$(LLVMSRCDIR)\bin\bin\LLVMObject.dll $(LLVMSRCDIR)\bin\bin\LLVMDebugInfoDWARF.dll

primitives.o: $(DIRSRC)\primitives.cpp $(DIRSRC)\primitives.h
	$(info primitives.o)
	$(COMPILER) $(CLOPT) $(DIRSRC)\primitives.cpp

entities.o: primitives.o $(DIRSRC)\entities.cpp $(DIRSRC)\entities.h primitives.o
	$(info entities.o)
	$(COMPILER) $(CLOPT) $(DIRSRC)\entities.cpp

imgjpg.o: entities.o $(DIRSRC)\imgjpg.cpp $(DIRSRC)\imgjpg.h
	$(info imgjpg.o)
	$(COMPILER) $(CLOPT) $(DIRSRC)\imgjpg.cpp

imgpng.o: entities.o $(DIRSRC)\imgpng.cpp $(DIRSRC)\imgpng.h
	$(info imgpng.o)
	$(COMPILER) $(CLOPT) $(DIRSRC)\imgpng.cpp

imgtga.o: entities.o $(DIRSRC)\imgtga.cpp $(DIRSRC)\imgtga.h
	$(info imgtga.o)
	$(COMPILER) $(CLOPT) $(DIRSRC)\imgtga.cpp

interfaces.o: imgjpg.o imgpng.o imgtga.o $(DIRSRC)\interfaces.cpp $(DIRSRC)\interfaces.h
	$(info interfaces.o)
	$(COMPILER) $(CLOPT) $(DIRSRC)\interfaces.cpp

win32.o: interfaces.o $(DIRSRC)\win32.cpp $(DIRSRC)\win32.h
	$(info win32.o)
	$(COMPILER) $(CLOPT) $(DIRSRC)\win32.cpp 

fbxutil.o: win32.o $(DIRSRC)\fbxutil.cpp $(DIRSRC)\fbxutil.h
	$(info fbxutil.o)
	$(COMPILER) $(CLOPT) $(DIRSRC)\fbxutil.cpp

enginelibMingW.dll: primitives.o entities.o imgjpg.o imgpng.o imgtga.o interfaces.o win32.o
	$(info enginelibMingW.dll)
	$(COMPILER) $(LIBPATH) -fpermissive -g -o enginelibMingW.dll -shared primitives.o entities.o imgjpg.o imgpng.o imgtga.o interfaces.o win32.o -Wl,--out-implib,engineMingW.a $(LLVMLIBS) $(WIN32LIBD) $(CLANGLIB)

engineMingW.exe: enginelibMingW.dll $(DIRSRC)\main.cpp
	$(info engineMingW.exe)
	$(COMPILER)  -fpermissive -g -w -O0 $(INCPATH) $(LIBPATH) -o engineMingW.exe enginelibMingW.dll $(DIRSRC)\main.cpp $(STATICCPPDRIVER) 

